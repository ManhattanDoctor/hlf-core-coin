### Назначение

**HLF Core Coin** — это библиотека на TypeScript, предназначенная для управления токенами (монетами) и их балансами в рамках финансовых или блокчейн-систем. Она реализует бизнес-логику для работы с аккаунтами, балансами, операциями с токенами, а также предоставляет инструменты для валидации, обработки ошибок и интеграции с внешними системами.

---

### Основные компоненты и их назначение

#### 1. CoinAccount.ts
- **Класс CoinAccount** — основной бизнес-объект, представляющий аккаунт пользователя для определённого токена.
- Содержит поля: `uid` (уникальный идентификатор), `held` (удержанные средства), `inUse` (доступные средства), `ownerUid` (владелец).
- Методы позволяют:
  - Пополнять баланс (`add`)
  - Удерживать средства (`hold`)
  - Списывать средства (`remove`)
  - Разблокировать удержанные средства (`unhold`)
  - Проверять пустой ли аккаунт (`isEmpty`)
  - Получать общий баланс (`getTotal`)
- Валидация значений реализована через декораторы (`class-validator`).

#### 2. CoinUtil.ts
- **Класс CoinUtil** — набор статических утилит для работы с токенами.
- Генерация и разбор уникальных идентификаторов токенов (UID).
- Проверка корректности UID.
- Преобразование сумм между разными представлениями (например, в "центы" и обратно).
- Вычисление процентов, арифметические операции с учётом точности (decimals).

#### 3. CoinBalance.ts
- Управление балансами токенов.
- Операции по увеличению, уменьшению, удержанию и разблокировке средств.
- Вспомогательные методы для получения информации о балансе.

#### 4. CoinAccountUtil.ts
- Вспомогательные функции для работы с аккаунтами токенов.
- Декомпозиция UID аккаунта, получение информации о владельце и токене.

#### 5. Coin.ts и CoinAmount.ts
- Описывают интерфейсы и базовые структуры для токенов и их количеств.

#### 6. Error.ts
- Кастомные классы ошибок для обработки бизнес-ошибок (например, недостаточно средств, некорректная сумма).
- Перечисление кодов ошибок (enum).
- Интерфейсы для передачи деталей ошибок.

#### 7. transport/
- Содержит команды и события для интеграции с внешними системами (например, для передачи информации о переводах, эмиссии, удержании и т.д.).
- Реализует паттерн Command/Event для взаимодействия между сервисами.

#### 8. public-api.ts и index.ts
- Точки входа для экспорта публичных API библиотеки.

---

### Ключевые особенности

- **Строгая типизация**: Использование TypeScript, интерфейсов и декораторов для валидации.
- **Модульность**: Логика разделена на отдельные файлы и классы по принципу единой ответственности.
- **Гибкая обработка ошибок**: Кастомные ошибки с кодами и деталями.
- **Расширяемость**: Легко добавлять новые типы токенов, операции и интеграции.
- **Интеграция с внешними системами**: Через папку `transport` реализованы команды и события для взаимодействия с другими сервисами.

---

### Пример сценария использования

1. **Создание аккаунта токена**:
   - Генерируется уникальный идентификатор (UID) для токена и владельца.
   - Создаётся объект CoinAccount с начальными значениями.

2. **Операции с балансом**:
   - Пополнение баланса (`add`)
   - Удержание средств для транзакции (`hold`)
   - Списание средств (`remove`)
   - Разблокировка удержанных средств (`unhold`)

3. **Обработка ошибок**:
   - Если сумма некорректна или недостаточно средств — выбрасывается соответствующая ошибка с подробностями.

4. **Интеграция**:
   - Через команды и события из `transport/` можно интегрировать библиотеку с внешними сервисами (например, для аудита, логирования, синхронизации).

---

### Для кого этот проект

- Для разработчиков, создающих финансовые сервисы, кошельки, блокчейн-приложения.
- Для интеграции с Hyperledger Fabric или другими DLT/блокчейн-платформами.
- Для построения надёжной и расширяемой системы учёта токенов.

---